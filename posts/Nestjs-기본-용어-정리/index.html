<!DOCTYPE html><html lang="ko" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Nestjs 기본 용어 정리" /><meta property="og:locale" content="ko" /><meta name="description" content="NestJS nest-js 구조 1 2 3 4 5 6 7 8 9 10 11 AppModule(root) ├──Module1 │ └──Controller │ └──Service │ └──.. │ └──.. ├──Module2 │ └──Controller │ └──Service │ └──.. │ └──.." /><meta property="og:description" content="NestJS nest-js 구조 1 2 3 4 5 6 7 8 9 10 11 AppModule(root) ├──Module1 │ └──Controller │ └──Service │ └──.. │ └──.. ├──Module2 │ └──Controller │ └──Service │ └──.. │ └──.." /><link rel="canonical" href="https://jotasic.github.io/posts/Nestjs-%EA%B8%B0%EB%B3%B8-%EC%9A%A9%EC%96%B4-%EC%A0%95%EB%A6%AC/" /><meta property="og:url" content="https://jotasic.github.io/posts/Nestjs-%EA%B8%B0%EB%B3%B8-%EC%9A%A9%EC%96%B4-%EC%A0%95%EB%A6%AC/" /><meta property="og:site_name" content="Tasic’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-30T11:33:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Nestjs 기본 용어 정리" /> <script type="application/ld+json"> {"description":"NestJS nest-js 구조 1 2 3 4 5 6 7 8 9 10 11 AppModule(root) ├──Module1 │ └──Controller │ └──Service │ └──.. │ └──.. ├──Module2 │ └──Controller │ └──Service │ └──.. │ └──..","url":"https://jotasic.github.io/posts/Nestjs-%EA%B8%B0%EB%B3%B8-%EC%9A%A9%EC%96%B4-%EC%A0%95%EB%A6%AC/","@type":"BlogPosting","headline":"Nestjs 기본 용어 정리","dateModified":"2021-11-30T11:33:00+09:00","datePublished":"2021-11-30T11:33:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jotasic.github.io/posts/Nestjs-%EA%B8%B0%EB%B3%B8-%EC%9A%A9%EC%96%B4-%EC%A0%95%EB%A6%AC/"},"@context":"https://schema.org"}</script><title>Nestjs 기본 용어 정리 | Tasic's blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tasic's blog"><meta name="application-name" content="Tasic's blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Tasic's blog</a></div><div class="site-subtitle font-italic">타식의 블로그</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/jotasic" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['embedded61','gamil.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Nestjs 기본 용어 정리</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Nestjs 기본 용어 정리</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Taewoo Kim </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Nov 30, 2021, 11:33 AM +0900" >Nov 30<i class="unloaded">2021-11-30T11:33:00+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1163 words">6 min read</span></div></div><div class="post-content"><h1 id="nestjs">NestJS</h1><p>nest-js 구조</p><div class="language-console highlighter-rouge"><div class="code-header"> <span text-data=" Console "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="go">AppModule(root)
├──Module1
│   └──Controller
│   └──Service
│   └──..
│   └──..
├──Module2
│   └──Controller
│   └──Service
│   └──..
│   └──..
</span></pre></table></code></div></div><h2 id="기본적인-명령어">기본적인 명령어</h2><h3 id="프로젝트-생성">프로젝트 생성</h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>npm i <span class="nt">-g</span> @nestjs/cli
nest new project-name
</pre></table></code></div></div><h3 id="모듈생성">모듈생성</h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nest g module module-name
</pre></table></code></div></div><h3 id="컨트롤러-생성">컨트롤러 생성</h3><p>컨트롤러는 들어오는 요청을 처리하고 클라이언트에 응답을 반환한다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nest g controller module-name
</pre></table></code></div></div><h3 id="서비스생성">서비스생성</h3><p>서비스 안에는 데이터베이스 관련된 로직을 처리한다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>nest g service module-name <span class="nt">--no-spec</span>
<span class="c"># --no-spce : 테스트 코드 생성 안함</span>
</pre></table></code></div></div><h2 id="type-orm">Type ORM</h2><h3 id="설치">설치</h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>npm <span class="nb">install </span>pg typeorm @nestjs/typeorm <span class="nt">--save</span>
<span class="c"># pg : postgres 모듈</span>
<span class="c"># typeorm : typeorm 모듈</span>
</pre></table></code></div></div><h3 id="설정">설정</h3><p>src &gt; configs &gt; <code class="language-console highlighter-rouge"><span class="go">typeorm.config.ts</span></code> 파일을 만든다.</p><div file="path/to/file" class="language-ts highlighter-rouge"><div class="code-header"> <span text-data="path/to/file"><i class="fa-fw far fa-file-code"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">TypeOrmModuleOptions</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nestjs/typeorm</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">config</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">config</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// 설정 파일 </span>

<span class="kd">const</span> <span class="nx">dbConfig</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">db</span><span class="dl">'</span><span class="p">);</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">typeORMConfig</span><span class="p">:</span> <span class="nx">TypeOrmModuleOptions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">type</span><span class="p">:</span> <span class="nx">dbConfig</span><span class="p">.</span><span class="kd">type</span><span class="p">,</span>
  <span class="na">host</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">RDS_HOSTNAME</span> <span class="o">||</span> <span class="nx">dbConfig</span><span class="p">.</span><span class="nx">host</span><span class="p">,</span>
  <span class="na">port</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">RDS_PORT</span> <span class="o">||</span> <span class="nx">dbConfig</span><span class="p">.</span><span class="nx">port</span><span class="p">,</span>
  <span class="na">username</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">RDS_USERNAME</span> <span class="o">||</span> <span class="nx">dbConfig</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span>
  <span class="na">password</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">RDS_PASSWORD</span> <span class="o">||</span> <span class="nx">dbConfig</span><span class="p">.</span><span class="nx">password</span><span class="p">,</span>
  <span class="na">database</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">RDS_DB_NAME</span> <span class="o">||</span> <span class="nx">dbConfig</span><span class="p">.</span><span class="nx">database</span><span class="p">,</span>
  <span class="na">entities</span><span class="p">:</span> <span class="p">[</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">/../**/*.entity.{js,ts}</span><span class="dl">'</span><span class="p">],</span> <span class="c1">// entity가 정의된 위치</span>
  <span class="na">synchronize</span><span class="p">:</span> <span class="nx">dbConfig</span><span class="p">.</span><span class="nx">synchronize</span><span class="p">,</span> <span class="c1">// true이면 entity가 변경시 해당 table 삭제 후, 다시 생성</span>
<span class="p">};</span>
</pre></table></code></div></div><h3 id="entity-작성">Entity 작성</h3><p>db table의 설계도 같은 느낌 (Django에서 Model과 비슷한 느낌) 각각의 모듈폴더 안에 xx.entity.ts에 작성한다.</p><div class="language-ts highlighter-rouge"><div class="code-header"> <span text-data=" TypeScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="p">@</span><span class="nd">Entity</span><span class="p">(</span><span class="dl">'</span><span class="s1">users</span><span class="dl">'</span><span class="p">)</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">User</span> <span class="kd">extends</span> <span class="nx">BaseEntity</span> <span class="p">{</span>
  <span class="p">@</span><span class="nd">PrimaryGeneratedColumn</span><span class="p">()</span>
  <span class="nx">pk</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>

  <span class="p">@</span><span class="nd">Column</span><span class="p">()</span>
  <span class="nx">id</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="p">@</span><span class="nd">Column</span><span class="p">()</span>
  <span class="nx">password</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="c1">//외레키 설정</span>
  <span class="c1">// OneToMany이면 Django에서 역참조라고 생각하면 된다.(_set으로 접근)</span>
  <span class="c1">// eager는 해당 모델을 가져올 때, userTires를 가져올지 설정하는 문구이다.</span>
  <span class="p">@</span><span class="nd">OneToMany</span><span class="p">((</span><span class="kd">type</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">UserTire</span><span class="p">,</span> <span class="p">(</span><span class="nx">userTire</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">userTire</span><span class="p">.</span><span class="nx">user</span><span class="p">,</span> <span class="p">{</span> <span class="na">eager</span><span class="p">:</span> <span class="kc">false</span> <span class="p">})</span>
  <span class="nx">userTires</span><span class="p">:</span> <span class="nx">UserTire</span><span class="p">[];</span>
<span class="p">}</span>
</pre></table></code></div></div><p>근데, ts는 카멜케이스 이니깐 컬럼명을 카멜케이스로 하면 db에도 카멜케이스 형태로 들어간다.</p><p>이것을 DB에 들어갈때는 스네이크 케이스로 하고 싶으면 다음과 같이하면된다.</p><div class="language-ts highlighter-rouge"><div class="code-header"> <span text-data=" TypeScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="p">@</span><span class="nd">Column</span><span class="p">({</span><span class="na">name</span><span class="p">:</span><span class="dl">'</span><span class="s1">created_at</span><span class="dl">'</span><span class="p">})</span>
<span class="nx">createdAt</span><span class="p">:</span> <span class="nb">Date</span>
</pre></table></code></div></div><p>하지만 이 방법은 번거럽고 실수 할 수 있다. 따라서 <a href="https://www.npmjs.com/package/typeorm-naming-strategies">typeorm-naming-strategies</a>를 사용해서 자동을 바뀔 수 있도록 한다.</p><div class="language-ts highlighter-rouge"><div class="code-header"> <span text-data=" TypeScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">const</span> <span class="nx">typeORMConfig</span><span class="p">:</span> <span class="nx">TypeOrmModuleOptions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// typeORMConfig에 다음과 같이 추가</span>
  <span class="na">namingStrategy</span><span class="p">:</span> <span class="k">new</span> <span class="nx">SnakeNamingStrategy</span><span class="p">(),</span>
</pre></table></code></div></div><h3 id="repository">Repository</h3><p>각 table의 CRUD를 하는 곳 Django에서 Manager(objects)랑 비슷한 느낌 각각의 모듈폴더 안에 xx.repository.ts에 작성한다. 기본적으로 Repository를 상속받은 형태로 작성하고, 추후 필요한 ORM을 메쏘드 형태로 만든다.</p><div class="language-ts highlighter-rouge"><div class="code-header"> <span text-data=" TypeScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">EntityRepository</span><span class="p">,</span> <span class="nx">Repository</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">typeorm</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">User</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./users.entity</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">EntityRepository</span><span class="p">(</span><span class="nx">User</span><span class="p">)</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">UserRepository</span> <span class="kd">extends</span> <span class="nx">Repository</span><span class="o">&lt;</span><span class="nx">User</span><span class="o">&gt;</span> <span class="p">{}</span>
</pre></table></code></div></div><p>만든 Repository를 Module에서 사용할 수 있도록 등록한다.</p><div class="language-ts highlighter-rouge"><div class="code-header"> <span text-data=" TypeScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="p">@</span><span class="nd">Module</span><span class="p">({</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[</span><span class="nx">TypeOrmModule</span><span class="p">.</span><span class="nx">forFeature</span><span class="p">([</span><span class="nx">UserRepository</span><span class="p">])],</span>
<span class="p">...</span>
<span class="p">})</span>
</pre></table></code></div></div><p>service 부분에서 사용하므로 다음과 같이 선언해서 사용한다.</p><p>ts에서는 생성자의 private 인자로 들어가면 자동으로 맴버 property가 된다.</p><div class="language-ts highlighter-rouge"><div class="code-header"> <span text-data=" TypeScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">UsersService</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="p">@</span><span class="nd">InjectRepository</span><span class="p">(</span><span class="nx">UserRepository</span><span class="p">)</span>
    <span class="k">private</span> <span class="nx">userRepository</span><span class="p">:</span> <span class="nx">UserRepository</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="dto">DTO</h2><p>계층간 데이터를 전송하기 위해서 필요한 객체이며, 해당 객체를 만들기 위해서는 아래와 같은 패키지가 필요함.</p><p>파이프 data transformation과data validation을 위해서 사용됨 transformation : 정수로 받았는데, 숫자로 변환 validation : 유효성 체크</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm <span class="nb">install </span>class-validator class-transformer <span class="nt">--save</span>
</pre></table></code></div></div><p>파이프는 핸들러, 파라미터, 글로벌 레벨 3가지로 나뉨 핸들러: 핸들러 하나의 작용(컨토롤러 함수 하나) 파라미터 : 파라미터 하나의 적용 글로벌 : 모든 요청에 적용</p><h2 id="로그인회원-가입">로그인/회원 가입</h2><h3 id="bcryptjs">bcryptjs</h3><p>bcryptjs 단방향 해쉬 알고리즘으로 회원가입시, 비밀번호를 암호화 하기위해 사용 다양한 언어로 되어 있고 사용방법도 거의 동일한 것 같다. <a href="https://www.npmjs.com/package/bcryptjs">참고</a></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm <span class="nb">install </span>bcryptjs <span class="nt">--save</span>
</pre></table></code></div></div><div class="language-ts highlighter-rouge"><div class="code-header"> <span text-data=" TypeScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">bcrypt</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">bcryptjs</span><span class="dl">'</span><span class="p">;</span>
</pre></table></code></div></div><h3 id="로그인인증">로그인/인증</h3><ul><li>jwt: 로그인 시에 인증정보를 암호화한다.<li>passport: 토큰이 유효한지 검사하고 user정보를 반환하는 기능을 수행한다. <a href="https://docs.nestjs.com/security/authentication">참고</a><div class="language-ts highlighter-rouge"><div class="code-header"> <span text-data=" TypeScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">npm</span> <span class="nx">install</span> <span class="p">@</span><span class="nd">nestjs</span><span class="sr">/jwt @nestjs/</span><span class="nx">passport</span> <span class="nx">passport</span> <span class="nx">passport</span><span class="o">-</span><span class="nx">jwt</span> <span class="o">--</span><span class="nx">save</span>
</pre></table></code></div></div></ul><h2 id="test">Test</h2><p>테스트 파일을 작성하면 에러가 날때가 있다. <code class="language-console highlighter-rouge"><span class="go">package.json</span></code>에서 <code class="language-console highlighter-rouge"><span class="go">jest</span></code> 찾아서 설정을 바꿔주자</p><div class="language-console highlighter-rouge"><div class="code-header"> <span text-data=" Console "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="go">  "jest": {
    "moduleDirectories": [
      "node_modules",
      "src"
    ],
    "moduleFileExtensions": [
      "js",
      "json",
      "ts"
    ],
    "roots": [
      "src"
    ],
</span><span class="gp">    "testRegex": ".spec.ts$</span><span class="s2">",
</span><span class="go">    "transform": {
</span><span class="gp">      "^.+\\.(t|j)s$</span><span class="s2">": "</span>ts-jest<span class="s2">"
</span><span class="go">    },
    "coverageDirectory": "../coverage",
    "testEnvironment": "node",
    "moduleNameMapper": {
</span><span class="gp">      "src/(.*)": "&lt;rootDir&gt;</span>/src/<span class="nv">$1</span><span class="s2">"
</span><span class="go">    }
  }
</span></pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/tip/'>Tip</a>, <a href='/categories/nest-js/'>Nest.js</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/nest-js/" class="post-tag no-text-decoration">nest.js</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Nestjs 기본 용어 정리 - Tasic's blog&url=https://jotasic.github.io/posts/Nestjs-%EA%B8%B0%EB%B3%B8-%EC%9A%A9%EC%96%B4-%EC%A0%95%EB%A6%AC/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Nestjs 기본 용어 정리 - Tasic's blog&u=https://jotasic.github.io/posts/Nestjs-%EA%B8%B0%EB%B3%B8-%EC%9A%A9%EC%96%B4-%EC%A0%95%EB%A6%AC/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Nestjs 기본 용어 정리 - Tasic's blog&url=https://jotasic.github.io/posts/Nestjs-%EA%B8%B0%EB%B3%B8-%EC%9A%A9%EC%96%B4-%EC%A0%95%EB%A6%AC/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/JS-Symbol/">Javascript Symbol</a><li><a href="/posts/JS-Iterable/">Javascript Iterable, iterator, generator</a><li><a href="/posts/Django-ORM-1PN-%EB%AC%B8%EC%A0%9C/">Django ORM 1+N문제</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/django/">django</a> <a class="post-tag" href="/tags/nest-js/">nest.js</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/typescript-%EC%97%B0%EC%82%B0%EC%9E%90%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%ED%83%80%EC%9E%85%EC%A0%95%EC%9D%98/"><div class="card-body"> <span class="timeago small" >Dec 4<i class="unloaded">2021-12-04T23:25:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Typescript 연산자를 이용한 타입정의</h3><div class="text-muted small"><p> 연산자를 이용한 타입정의 Union Tpye 유니온 타입(Union Type)이란 자바스크립트의 OR 연산자와 같이 A이거나 B이다 라는 의미의 타입이다. 이처럼 any를 사용하는 경우 마치 자바스크립트로 작성하는 것처럼 동작을 하고 유니온 타입을 사용하면 타입스크립트의 이점을 살리면서 코딩할 수 있다. 1 2 3 4 5 6 7 8 9 10 11...</p></div></div></a></div><div class="card"> <a href="/posts/Django-ORM-1PN-%EB%AC%B8%EC%A0%9C/"><div class="card-body"> <span class="timeago small" >Dec 3<i class="unloaded">2021-12-03T23:55:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Django ORM 1+N문제</h3><div class="text-muted small"><p> ORM N+1 문제 django ORM은 Lazy-Loading 방식입니다. Lazy-Loading 방식을 사용하면 ORM에서 명령을 실행할 때마다 데이터베이스에서 데이터를 가져오는 것이 아니라 실제로 데이터를 불러와야 할 시점에 데이터베이스에 쿼리를 실행하는 방식입니다. 그래서 다음과 같이 QRM를 통해서 db의 data를 접근하면, n+1번 쿼리...</p></div></div></a></div><div class="card"> <a href="/posts/typescript-%EA%B8%B0%EB%B3%B8%ED%83%80%EC%9E%85-%ED%95%A8%EC%88%98-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4/"><div class="card-body"> <span class="timeago small" >Dec 4<i class="unloaded">2021-12-04T12:50:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Typescript 기본타입, 함수, 인터페이스</h3><div class="text-muted small"><p> 타입스크립트 기본 타입 타입스크립트에는 12가지 기본타입이 있다. String 문자열을 나타냄 1 let str: string = 'hi'; Number 숫자를 나타냄 1 let num: number = 10; Boolean 참/거짓을 나타냄 1 let isLoggedIn: boolean = false; Object 이름과 값으로 구...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/Django-ORM-1PN-%EB%AC%B8%EC%A0%9C/" class="btn btn-outline-primary" prompt="Newer"><p>Django ORM 1+N문제</p></a></div><script src="https://utteranc.es/client.js" repo="jotasic/jotasic.github.io" issue-term="pathname" theme="github-dark" crossorigin="anonymous" async> </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/jotasic">Taewoo Kim</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/django/">django</a> <a class="post-tag" href="/tags/nest-js/">nest.js</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
